<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>JD Analyzer</title>

  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      background: #f6f8fa;
      margin: 0;
      padding: 0;
    }

    .container {
      max-width: 800px;
      margin: 80px auto;
      background: white;
      padding: 40px;
      border-radius: 12px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.08);
    }

    h1 {
      text-align: center;
      margin-top: 0;
    }

    .subtitle {
      text-align: center;
      color: #666;
      margin-bottom: 30px;
    }

    .mode-switch {
      display: flex;
      gap: 20px;
      margin-bottom: 20px;
    }

    textarea, input[type="text"] {
      width: 100%;
      padding: 14px;
      font-size: 14px;
      border-radius: 8px;
      border: 1px solid #ccc;
    }

    textarea {
      min-height: 160px;
    }

    button {
      margin-top: 20px;
      background: #4f46e5;
      color: white;
      border: none;
      border-radius: 8px;
      padding: 12px 20px;
      font-size: 15px;
      cursor: pointer;
    }

    button:hover {
      background: #4338ca;
    }

    .result {
      margin-top: 40px;
    }

    .tag {
      display: inline-block;
      background: #e0e7ff;
      color: #3730a3;
      padding: 6px 12px;
      border-radius: 999px;
      margin: 4px;
      font-size: 13px;
    }

    .loading {
      color: #4f46e5;
      font-weight: 500;
    }
  </style>
</head>

<body>
<div class="container">
  <h1>Job Description Analyzer</h1>
  <div class="subtitle">Analyze via URL or paste JD text directly</div>

  <!-- Ê®°ÂºèÈÄâÊã© -->
  <div class="mode-switch">
    <label>
      <input type="radio" name="mode" value="url" checked />
      URL
    </label>
    <label>
      <input type="radio" name="mode" value="text" />
      Text
    </label>
  </div>

  <!-- URL ËæìÂÖ• -->
  <div id="urlBox">
    <input id="jobUrl" type="text" placeholder="Paste job posting URL" />
  </div>

  <!-- Text ËæìÂÖ• -->
  <div id="textBox" style="display:none;">
    <textarea id="jobText" placeholder="Paste job description text here..."></textarea>
  </div>

  <button onclick="analyze()">üîç Analyze</button>

  <!-- ÁªìÊûú -->
  <div class="result" id="result"></div>
</div>

<script>
function analyze() {
  const mode = document.querySelector('input[name="mode"]:checked').value;
  const resultDiv = document.getElementById("result");

  resultDiv.innerHTML = "<div class='loading'>Analyzing...</div>";

  let payload = { mode };

  if (mode === "url") {
    payload.job_url = document.getElementById("jobUrl").value;
  } else {
    payload.job_text = document.getElementById("jobText").value;
  }

  fetch("/analyze", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify(payload)
  })
  .then(res => res.json())
  .then(data => {
    if (data.error) {
      resultDiv.innerHTML = "<b>Error:</b> " + data.error;
      return;
    }

    resultDiv.innerHTML = `
      <h3>${data.job_title || ""}</h3>
      <p><b>Company:</b> ${data.company || ""}</p>
      <p><b>Seniority:</b> ${data.seniority || ""}</p>
      <p><b>Degree:</b> ${(data.degree_requirement || []).join(", ")}</p>

      <h4>Required Skills</h4>
      ${(data.required_skills || []).map(s => `<span class="tag">${s}</span>`).join("")}

      <h4>Preferred Skills</h4>
      ${(data.preferred_skills || []).length
        ? data.preferred_skills.map(s => `<span class="tag">${s}</span>`).join("")
        : "<p>None</p>"}
    `;
  })
  .catch(() => {
    resultDiv.innerHTML = "<b>Error analyzing job description.</b>";
  });
}

// ÂàáÊç¢ËæìÂÖ•Ê°Ü
document.querySelectorAll('input[name="mode"]').forEach(radio => {
  radio.addEventListener("change", () => {
    document.getElementById("urlBox").style.display =
      radio.value === "url" && radio.checked ? "block" : "none";

    document.getElementById("textBox").style.display =
      radio.value === "text" && radio.checked ? "block" : "none";
  });
});
</script>
</body>
</html>
